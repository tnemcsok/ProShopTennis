{"version":3,"file":"static/webpack/static\\development\\pages\\scheduled.js.31391b29174ff1d44e34.hot-update.js","sources":["webpack:///./components/ScheduledComp.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport gql from 'graphql-tag';\r\nimport { Query } from 'react-apollo';\r\nimport { Mutation } from 'react-apollo';\r\nimport styled from 'styled-components';\r\nimport User from './User';\r\nimport Link from 'next/link';\r\n\r\n\r\nconst SingleCompetitionStyles = styled.div`\r\n  h6 {\r\n      font-size: 1.6rem;\r\n      margin-bottom: 10px;\r\n      margin-top: 10px;\r\n  }\r\n\r\n  ul {\r\n    list-style-type: none;\r\n  }\r\n\r\n  form {\r\n    background-color: hsla(207, 20%, 91%,1);\r\n    padding: 25px;\r\n    width: 400px;\r\n    margin-left: 80px;\r\n  }\r\n\r\n  form.h2 {\r\n    margin-top: 0px;\r\n\r\n  }\r\n\r\n  .login {\r\n    background-color: hsla(207, 20%, 91%,1);\r\n    padding: 25px;\r\n    width: 400px;\r\n    margin-left: 80px;\r\n  }\r\n\r\n  .login.h6 {\r\n      font-size: 1.2rem;\r\n  }\r\n\r\n  .details {\r\n    display: grid;\r\n    grid-template-columns: 100px 200px;\r\n    grid-row-gap: 20px;\r\n    align-items: center;\r\n    padding-left: 15px;\r\n    line-height: 2.6;\r\n  }\r\n\r\n  a {\r\n    background: rgb(64, 126, 147);\r\n    color: white;\r\n    border: 0;\r\n    display: block;\r\n    margin: 0 auto;\r\n    text-align: center;\r\n    width: 150px;\r\n    font-size: 1.6rem;\r\n    font-weight: 600;\r\n    padding: 0.5rem 1.2rem;\r\n  }\r\n\r\n  input {\r\n    margin-left: 20px;\r\n    min-width: 200px;\r\n  }\r\n\r\n  .entrants {\r\n    display: flex;\r\n  }\r\n\r\n  .registered {\r\n    margin-left: 20px;\r\n    background-color: hsla(207, 20%, 91%,1);\r\n    padding: 25px;\r\n  }\r\n\r\n  button {\r\n    max-width: 70px;\r\n    font-size: 1.5rem;\r\n    color: white;\r\n    background-color: ${props => props.theme.green};\r\n    padding: 5px;\r\n    grid-column: 1 / 3;\r\n    justify-self: center;\r\n}\r\n\r\n\r\n\r\n`;\r\n\r\nconst SINGLE_SCHEDULED_QUERY = gql`\r\n  query SINGLE_SCHEDULED_QUERY($id: ID!) {\r\n    scheduledComp(where: { id: $id }) {\r\n      id\r\n      type\r\n      date\r\n      place\r\n      start\r\n    }\r\n  }\r\n`;\r\n\r\nconst ADD_ENTRANT_MUTATION = gql`\r\n  mutation ADD_ENTRANT_MUTATION(\r\n    $id: ID!\r\n    $entrant: String!\r\n    $phonenumber: String!\r\n    $email: String!\r\n    ) {\r\n    updateScheduledComp(\r\n      id: $id\r\n      entrant: $entrant \r\n      phonenumber: $phonenumber\r\n      email: $email\r\n\r\n      ) {\r\n      id\r\n    }\r\n  }\r\n`;\r\n\r\nconst GET_ENTRANTS_QUERY = gql`\r\n  query GET_ENTRANTS_QUERY($id: ID!) {\r\n    entrants(where: { scheduledComps_every: {id: $id} }) {\r\n      phonenumber\r\n      email\r\n      name\r\n    }\r\n  }\r\n`;\r\n\r\n\r\nclass ScheduledComp extends Component {\r\n\r\n  state = {\r\n    entrant: '',\r\n    phonenumber: '',\r\n    email: '',\r\n    id: this.props.id\r\n  };\r\n\r\n  cancelCourse = () => { \r\n    document.getElementById(\"register_form\").reset();\r\n  }\r\n\r\n  saveToState = e => {\r\n    const { name, value } = e.target;\r\n    \r\n    this.setState({ [name]: value });\r\n  };\r\n  \r\n  render() {\r\n    return (\r\n      <User>\r\n      {({ data: { me } }) => (\r\n        <Query\r\n          query={SINGLE_SCHEDULED_QUERY}\r\n          variables={{\r\n            id: this.state.id,\r\n          }}\r\n        >\r\n          {({ error, loading, data }) => {\r\n\r\n              console.log(data);\r\n            if (error) return <Error error={error} />;\r\n            if (loading) return <p>Loading...</p>;\r\n            if (!data.scheduledComp) return <p>No Item Found for {this.props.id}</p>;\r\n            \r\n            const scheduledComp = data.scheduledComp;\r\n\r\n            return (\r\n              <SingleCompetitionStyles>\r\n                \r\n                \r\n                  <h2>{scheduledComp.date}: {scheduledComp.type}</h2>\r\n                  <p>Helyszín: {scheduledComp.place}</p>\r\n                  <p>Kezdés: {scheduledComp.start}</p>\r\n                  <div className=\"entrants\">\r\n                  <div className=\"registered\">\r\n                    <h6>Eddigi nevezők:</h6>\r\n                    <Query\r\n                      query={GET_ENTRANTS_QUERY}\r\n                      variables={{\r\n                        id: this.state.id,\r\n                      }}\r\n                    >\r\n                      {({ error, loading, data }) => {\r\n\r\n                          \r\n                        if (error) return <p>Error: {error.message}</p>;\r\n                        if (loading) return <p>Loading...</p>;\r\n                        if (!data.entrants) return <p>Még nincsenek nevezők</p>;\r\n\r\n                        console.log(data.entrants);\r\n                        \r\n                        return(\r\n                        <div>\r\n                          {data.entrants.map((entrant, index) => {\r\n                            console.log(entrant);\r\n                            return(\r\n                                <p>{index+1}. {entrant.name}</p>\r\n                            )\r\n                          })}\r\n                        </div>  \r\n                        )\r\n                      }}\r\n                    </Query>\r\n                      \r\n                    </div>\r\n                    <Mutation \r\n                      mutation={ADD_ENTRANT_MUTATION} \r\n                      variables={this.state}\r\n                      refetchQueries={ [ {query: GET_ENTRANTS_QUERY, variables: { id: this.state.id }}] }  \r\n                    >\r\n                    {(updateScheduledComp, { loading, error }) => (\r\n                    <div>\r\n                    {me && (\r\n                    <form id=\"register_form\" onSubmit={async e => {\r\n                      \r\n                                  // Stop the form from submitting\r\n                                  e.preventDefault();\r\n                                  // call the mutation\r\n                                  const res = await updateScheduledComp();\r\n                                  // change them to the single item page\r\n                                  console.log(res);\r\n                                  this.cancelCourse();\r\n                                  }}>\r\n                      \r\n                      <h6>Nevezés</h6>\r\n                      <div className=\"details\">\r\n                        <label for=\"name\">Név:</label>\r\n                                      <input\r\n                                          type=\"text\"\r\n                                          name=\"entrant\"\r\n                                          placeholder=\"Név\"\r\n                                          onChange={this.saveToState}\r\n                                      />\r\n\r\n                        <label for=\"name\">Telefonszám:</label>\r\n                                      <input\r\n                                          type=\"text\"\r\n                                          name=\"phonenumber\"\r\n                                          placeholder=\"+36-20-123-45-67\"\r\n                                          onChange={this.saveToState}\r\n                                      />\r\n\r\n                        <label for=\"email\">Email:</label>\r\n                                      <input\r\n                                          type=\"email\"\r\n                                          name=\"email\"\r\n                                          placeholder=\"Email\"\r\n                                          onChange={this.saveToState}\r\n                                      />\r\n                        <button type=\"submit\">Nevezés</button>           \r\n                      </div>\r\n                      \r\n                    </form>\r\n                      )}\r\n                      {!me && (\r\n                        <div className=\"login\">\r\n                          <h6>A nevezéshez kérjük jelentkezzen be!</h6>\r\n                          <Link href=\"/login\">\r\n                            <a>Bejelentkezés</a>\r\n                          </Link>\r\n\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    )}\r\n                </Mutation>\r\n                  </div>\r\n                  \r\n\r\n                \r\n              </SingleCompetitionStyles>\r\n            );\r\n          }}\r\n        </Query>\r\n      )}\r\n      </User>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ScheduledComp;\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAAA;AAAA;AAAA;AA2EA;AAAA;AAUA;AAYA;AAmBA;AACA;AAUA;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AACA;AAJA;AACA;AAMA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;;;;;;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AADA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AADA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAGA;AAKA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAJA;AAAA;AACA;AADA;AAKA;AACA;AACA;AACA;AAAA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAhDA;AA8DA;AA1HA;AA+HA;;;;AArJA;AACA;AAuJA;;;;A","sourceRoot":""}